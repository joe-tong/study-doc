# Spring中的循环依赖（面试必杀技）

## 1. 面试场景:

```
当面试官问:

       "请讲一下Spring中的循环依赖"的时候
       
我们到底该怎么回答？

主要从下面几点回答：
1. 什么是循环依赖
2. 什么情况下循环依赖可以被处理？
3. Spring是如何解决循环依赖
```

## 2. 什么是循环依赖?

概念: 理解就是A依赖B的同时B也依赖了A

```
@Component
public class A {
    // A中注入了B
 @Autowired
 private B b;
}

@Component
public class B {
    // B中也注入了A
 @Autowired
 private A a;
}
```

## 3. 什么情况下循环依赖可以被处理？

**Spring解决循环依赖是有前置条件的:**

- 循环依赖的Bean必须是单例的
- 依赖注入方式不能全是构造器注入的方式



### 3.1 循环依赖的Bean必须是单例的

### 3.2 依赖注入方式不能全是构造器注入的方式

我大概做了四种测试得到的结果，代码太简单了，就不演示了

| 依赖情况         | 依赖注入方式                         | 循环依赖是否被解决 |
| ------------ | ------------------------------ | --------- |
| AB相互依赖（循环依赖） | 均采用setter方法注入                  | 是         |
| AB相互依赖（循环依赖） | 均采用构造器注入                       | 否         |
| AB相互依赖（循环依赖） | A中注入B的方式为setter方法，B中注入A的方式为构造器 | 是         |
| AB相互依赖（循环依赖） | B中注入A的方式为setter方法，A中注入B的方式为构造器 | 否         |

我们发现不仅仅只有在setter方法注入的情况下循环依赖才能被解决，即使存在构造器注入的场景下，循环依赖依然被可以被正常处理掉。

## 3.3 Spring是如何解决循环依赖的？

